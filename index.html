<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è‡ªç„¶ç§‘æ•™å®¤äº’å‹•åº§ä½è¡¨ç¥å™¨</title>
<style>
  body { 
    font-family: "Microsoft JhengHei", sans-serif; 
    text-align: center; 
    background-color: #f4f6f9; 
    margin: 0; 
    padding: 0;
  }
  /* å°è¦½åˆ—è¨­è¨ˆ */
  .navbar {
    background-color: #34495e;
    padding: 15px 0;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    position: sticky;
    top: 0;
    z-index: 100;
  }
  .nav-btn {
    background-color: transparent;
    color: white;
    border: 2px solid transparent;
    padding: 8px 16px;
    margin: 0 5px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    border-radius: 5px;
    transition: 0.3s;
  }
  .nav-btn:hover { background-color: rgba(255,255,255,0.1); }
  .nav-btn.active { border-color: #3498db; background-color: #2980b9; }
  
  /* æ•™å®¤ä½ˆæ™¯ */
  h2 { color: #2c3e50; margin-top: 20px; }
  .blackboard { 
    background-color: #2c3e50; color: white; width: 60%; 
    margin: 10px auto 30px auto; padding: 12px; border-radius: 8px; 
    font-weight: bold; letter-spacing: 5px; font-size: 1.2em;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
  }
  .row { display: flex; justify-content: center; gap: 30px; margin-bottom: 40px; }
  .back-row { gap: 80px; }
  
  /* åº§ä½ç¶²æ ¼è¨­è¨ˆ */
  .table-group { 
    background-color: white; border: 2px solid #34495e; border-radius: 10px; 
    padding: 15px; width: 250px; box-shadow: 3px 3px 10px rgba(0,0,0,0.08); 
  }
  .table-title { 
    font-weight: bold; font-size: 1.2em; margin-bottom: 10px; 
    color: #e74c3c; border-bottom: 2px solid #ecf0f1; padding-bottom: 5px; 
  }
  .seat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
  
  /* å–®ä¸€åº§ä½å¡ç‰‡ */
  .seat { 
    padding: 10px 5px; border-radius: 5px; font-weight: bold; 
    border: 2px dashed #bdc3c7; height: 42px; 
    display: flex; align-items: center; justify-content: center;
    cursor: grab; transition: transform 0.2s, box-shadow 0.2s;
    user-select: none;
  }
  .seat:active { cursor: grabbing; transform: scale(0.95); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
  .seat.drag-over { border: 2px solid #e74c3c; background-color: #fff3e0; }
  
  /* é¡è‰²è¨­å®š */
  .boy { background-color: #e3f2fd; color: #1565c0; border-color: #90caf9;}
  .girl { background-color: #fce4ec; color: #c2185b; border-color: #f48fb1;}
  .empty { background-color: #f8f9fa; color: #ced4da; border-color: #e9ecef; }
  
  /* å§“åç·¨è¼¯å€ */
  .edit-text {
    width: 100%; outline: none; line-height: 1.3;
  }
  .edit-text:focus {
    background-color: rgba(255,255,255,0.7);
    border-radius: 3px;
  }
  
  /* æç¤ºæ–‡å­— */
  .hint { color: #7f8c8d; font-size: 14px; margin-bottom: 20px; }
</style>
</head>
<body>

  <div class="navbar" id="navbar">
    <button class="nav-btn active" onclick="switchClass('601')">601ç­</button>
    <button class="nav-btn" onclick="switchClass('602')">602ç­</button>
    <button class="nav-btn" onclick="switchClass('603')">603ç­</button>
    <button class="nav-btn" onclick="switchClass('604')">604ç­</button>
    <button class="nav-btn" onclick="switchClass('605')">605ç­</button>
    <button class="nav-btn" onclick="switchClass('606')">606ç­</button>
    <button class="nav-btn" onclick="switchClass('607')">607ç­</button>
  </div>

  <h2 id="class-title">601 è‡ªç„¶æ•™å®¤åº§ä½è¡¨</h2>
  <div class="hint">ğŸ’¡ æç¤ºï¼šæŒ‰ä½åº§ä½å¯ã€Œæ‹–æ›³äº¤æ›ã€ / åœ¨æ ¼å­ä¸Šã€Œé€£é»å…©ä¸‹ã€åˆ‡æ›ç”·å¥³é¡è‰² / é»æ“Šæ–‡å­—å¯ç›´æ¥ç·¨è¼¯</div>
  
  <div class="blackboard">è¬› å°</div>

  <div id="seat-container"></div>

<script>
  // 601 åˆ° 607 çš„å®Œç¾åˆå§‹åº§ä½æ•¸æ“š
  // E:ç©ºä½, B:ç”·ç”Ÿ, G:å¥³ç”Ÿ
  const classData = {
    "601": [
      ["E", "G,15,é‚±æ²æ©", "G,25,æ›¾ç·—å©•", "B,14,å”ç†™é ", "B,7,æ±Ÿæ·ç¶¸", "G,19,å‘‚è‹¥æ…ˆ"], // 3çµ„
      ["E", "B,6,è•­æ˜±æ„·", "B,4,æå°šè¬™", "G,18,é»ƒå…ç”¯", "G,23,é­å¥•æ¬£", "B,1,é™³å¾·ç€š"],   // 2çµ„
      ["E", "B,2,æ²ˆæ›¸æ¥·", "B,10,é»ƒæµšæ»", "G,24,å‘‚å®‰æ·‡", "G,16,è€¿æ¢“è–°", "B,5,å¼µç¦¹çš“"],   // 1çµ„
      ["B,9,é‚±å† ç¨‹", "G,17,è³´å­œæ¬£", "G,20,è¨±è‹¡æ¦•", "B,12,å¼µæ°‘ç¥º", "B,13,æå¨é”", "G,27,é»ƒå–¬ç‘€"], // 5çµ„
      ["G,26,å“å©·ä¿", "B,3,æ¢ç¿ç¾¤", "B,11,è‘‰ä½³ç¿°", "G,21,è¶™èŠ¸", "G,22,ç‹èŠŠäº‘", "B,8,æå®‡å®¸"]    // 4çµ„
    ],
    "602": [
      ["E", "B,1,ç¾…å°‘å»·", "G,23,ç°¡å½¤ç´œ", "G,22,è¬å®œè»’", "B,10,å”å®‰ç¦¹", "B,4,å»–æ–‡è¾°"],
      ["E", "G,27,å‘‚æ¬£æ¨º", "B,5,ææ…¶å®", "B,15,é¦¬æ˜•", "G,20,å¼µæ¬£é›", "G,24,ä¼åº­è±"],
      ["E", "B,2,é™³ç¾¿å¿—", "G,21,é¡å©•å¦®", "G,26,é™³è‘¦åº­", "B,8,æ—æšå®¸", "B,9,æ—æšåº­"],
      ["E", "B,3,å¼µå®‡ç¿”", "G,19,é™³é–ç‘¤", "G,16,å¼µåº­æ¦›", "B,11,æ—ç¥å»·", "B,6,å³å®¶æ¾”"],
      ["G,18,è¨±å®¥å¿ƒ", "B,13,å¾é›‹èŒ—", "B,12,ç‹å¢¨ç¨‹", "G,25,è¢è™ç”¯", "G,17,é™³ç¾½ç†™", "B,7,æœ±ç‰æˆ"]
    ],
    "603": [
      ["E", "B,7,ä½•å®¥å¯¬", "B,13,é­éƒéœ–", "G,18,æœ±èŠŠéœ“", "G,16,é™³å©·å„€", "B,9,æ¥Šæ˜±ç©"],
      ["E", "B,27,é™³ç¦¹å–†", "B,12,é™³éŒ¦ç¿”", "G,19,æœ±è© æš„", "G,25,é¾æ·‡éƒ", "B,4,æå®¥éœ†"],
      ["E", "G,24,é‚±æš„è€˜", "G,15,å§œç©ç‘„", "B,6,é«˜è¸è–³", "B,11,é‚±é¨°", "G,20,éƒ­éœæ…§"],
      ["E", "B,1,å³å½¥éœ†", "B,3,æå¸›è¬™", "G,17,ç‹äº¦ç­‘", "G,22,å§šå“å¦˜", "B,2,å‘è©£æ°"],
      ["B,8,åŠ‰é¨æ¨‚", "G,26,è³´å®œå‡", "G,23,æ¥Šå®œæ¨º", "B,10,é™³æ˜Ÿç¿", "B,5,æœ±å®¥éš†", "G,21,å³ç´«è‘³"]
    ],
    "604": [
      ["E", "B,8,è¨±å®¥ä¿Š", "B,4,ç‹å®¸å®‡", "G,23,å³è»’ç”„", "G,26,åŠ‰èŠ·å¦", "G,18,æ—èƒ¤å¦ƒ"],
      ["E", "B,9,é‚±æ‡¿å¸·", "B,2,å¼µå®¶æº", "G,22,æ—å©§è¡", "G,24,è¨±æƒ ç­‘", "B,7,æä»¥å‹’"],
      ["E", "G,16,é™³æ€è‘›", "G,14,é«˜å¹³æ½”", "B,12,å»–ç‚ºç†™", "B,1,é™³å“è«º", "G,17,è¶™å­å¦"],
      ["E", "E", "B,5,èŠæ‰¿ç„Œ", "G,15,é¾äºˆå€¢", "G,20,é„­ä¼ƒç", "B,10,æ¥Šå®¤æ©"],
      ["E", "B,13,å½­å­éŠ“", "B,6,æ±Ÿå­æ¨µ", "G,21,æ±Ÿæ˜•å¯°", "G,19,è–›éˆºç„", "G,25,å¼µäº‘è“"]
    ],
    "605": [
      ["E", "B,5,åŠ‰å®¹ç¶­", "B,13,é™³ç«‹çš“", "G,25,æ›¾è‹¡ç‘„", "G,18,æ®µå¿ƒèŠ¸", "B,9,é™³é †è©®"],
      ["E", "B,14,é„­ç¥ä¾–", "B,8,å³å®¥éœ†", "G,24,é™³æ˜€åº­", "G,20,é™³åº­è±", "B,3,å®‹å®å½§"],
      ["E", "B,6,ææ°ç¥", "B,15,å¾ä»¥åº­", "G,17,å¼µè‘¦åº­", "G,19,åŠ‰èŠŠç’‡", "B,10,é«˜é–å‚‘"],
      ["B,1,é™³æ˜Ÿå®‡", "G,16,é»ƒé‡‡å½¤", "G,21,ä½•å€¢ç‘„", "B,4,è¬ç¦¹ç¥¥", "B,12,ä½•è±«æ˜•", "G,26,åŠ‰è•å„€"],
      ["B,11,æ›¾å®‡è±ª", "G,27,æ›¹ç‘€æ¡", "G,23,é‚±å­èŠ¯", "B,2,æ¸©é›¨å®¬", "B,7,é»ƒä¸–ç‘‹", "G,22,å³æ²è”“"]
    ],
    "606": [
      ["B,13,è”¡é–”ç¾¿", "G,24,èŠæƒŸæ™´", "G,28,é»ƒè©©æ¶µ", "B,10,ç¾…å•“ç¿", "B,3,æ¸¸æ›œèª ", "G,21,ç°¡å¦¤æ™´"], // 606çš„3çµ„æ˜¯6äººæ»¿ç·¨
      ["E", "G,20,æ¥Šå§µå¬Œ", "B,7,ç§¦è‹¥æ¡“", "B,11,å³å®¸ç·¯", "G,18,é™³å¯èŠ¯", "G,25,æ—æ²›è¾°"],
      ["E", "B,5,å¾éœ†æ©", "G,19,æ—èŠ¯äº˜", "G,16,æ–½å¯èŠ¯", "B,9,è¨±çš“å´´", "B,4,å¼µå‡±å‚‘"],
      ["B,1,å½­å®‡æš", "G,23,æ­èŠ®å®¸", "G,27,é‚±èŠ¸å‡¡", "B,14,èŒƒç¶±å®‡", "B,2,é»ƒå…ƒå’Œ", "G,22,å³éœè±"],
      ["B,12,å»–èŠƒå‡±", "G,15,é™³å©·å®‡", "G,17,é™³å®£å„’", "B,6,é¦¬æŸæ£®", "B,8,ä½•ä½³å¡", "G,26,ä½•æ¢“åœ»"]
    ],
    "607": [
      ["E", "B,5,æ¸¸æ‰¿å¡", "G,18,é™³å¦è“‰", "G,22,å°¤è‹¥ç©", "B,9,å³ç§‰å‹³", "G,27,ç‹ç§€èŠ³"],
      ["E", "B,2,ç‹å¼˜æ¯…", "G,19,æ—èŠ·ä¼ƒ", "G,23,è”¡å®‡æ™´", "B,7,è©¹ä¸æ©", "B,10,è”¡æ˜ç†™"],
      ["E", "G,25,ç™½èŠ·ç‘„", "B,1,é»ƒæ¥·å€«", "B,4,å‘‚å®¸ç¾½", "G,20,é¾”æ¹˜å©·", "G,28,ææ›‰è“"],
      ["B,12,è¨±ç¿å®¸", "G,21,å¾å¸¸æ©", "G,16,é¢¨ä½³ç’‡", "B,13,å‘¨å®¸ç·¯", "B,11,è°·æ›¸ç·¯", "G,17,æŸå¦§è“"],
      ["B,8,æ¸¸é›¨é´»", "G,14,å¼µå®‰ç·¹", "G,15,åŠ‰èŠ¯èŠ¸", "B,3,é™³æ†²é¨°", "B,6,é»ƒé–å£¬", "G,24,é˜æ²›æ¶µ"]
    ]
  };

  const groupTitles = ["ç¬¬ä¸‰çµ„", "ç¬¬äºŒçµ„", "ç¬¬ä¸€çµ„", "ç¬¬äº”çµ„", "ç¬¬å››çµ„"];

  // æ¸²æŸ“ç­ç´š
  function renderClass(classId) {
    document.getElementById('class-title').innerText = `${classId} è‡ªç„¶æ•™å®¤åº§ä½è¡¨`;
    const container = document.getElementById('seat-container');
    container.innerHTML = '';
    const groups = classData[classId];

    // å‰æ’ (3çµ„, 2çµ„, 1çµ„)
    let frontRow = document.createElement('div');
    frontRow.className = 'row';
    for(let i = 0; i < 3; i++) {
      frontRow.appendChild(createGroupNode(groupTitles[i], groups[i]));
    }
    container.appendChild(frontRow);

    // å¾Œæ’ (5çµ„, 4çµ„)
    let backRow = document.createElement('div');
    backRow.className = 'row back-row';
    for(let i = 3; i < 5; i++) {
      backRow.appendChild(createGroupNode(groupTitles[i], groups[i]));
    }
    container.appendChild(backRow);

    // é‡æ–°ç¶å®šäº‹ä»¶
    attachDragAndDropEvents();
    attachEditEvents();
  }

  // å‰µå»ºå°çµ„ DOM
  function createGroupNode(title, seats) {
    let groupDiv = document.createElement('div');
    groupDiv.className = 'table-group';

    let count = seats.filter(s => s !== 'E').length;
    let titleDiv = document.createElement('div');
    titleDiv.className = 'table-title';
    titleDiv.innerText = `${title} (${count}äºº)`;
    groupDiv.appendChild(titleDiv);

    let gridDiv = document.createElement('div');
    gridDiv.className = 'seat-grid';

    seats.forEach(seatData => {
      let seatDiv = document.createElement('div');
      seatDiv.className = 'seat';
      seatDiv.setAttribute('draggable', 'true'); // å…è¨±æ‹–æ›³

      // é›™æ“Šåˆ‡æ›æ€§åˆ¥é¡è‰²
      seatDiv.addEventListener('dblclick', toggleGender);

      let innerSpan = document.createElement('span');
      innerSpan.className = 'edit-text';
      innerSpan.setAttribute('contenteditable', 'true'); // å…è¨±æ–‡å­—ç·¨è¼¯

      if (seatData === 'E') {
        seatDiv.classList.add('empty');
        innerSpan.innerHTML = `(ç©ºä½)`;
      } else {
        let parts = seatData.split(',');
        let type = parts[0] === 'B' ? 'boy' : 'girl';
        let genderText = parts[0] === 'B' ? 'ç”·' : 'å¥³';
        seatDiv.classList.add(type);
        innerSpan.innerHTML = `${genderText} ${parts[1]}è™Ÿ<br>${parts[2]}`;
      }
      
      seatDiv.appendChild(innerSpan);
      gridDiv.appendChild(seatDiv);
    });

    groupDiv.appendChild(gridDiv);
    return groupDiv;
  }

  // åˆ‡æ›ç­ç´šæŒ‰éˆ•é‚è¼¯
  function switchClass(classId) {
    document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    renderClass(classId);
  }

  // ---- æ ¸å¿ƒé‚è¼¯ï¼šæ€§åˆ¥åˆ‡æ› (é›™æ“Š) ----
  function toggleGender(e) {
    let seat = e.currentTarget;
    let span = seat.querySelector('.edit-text');

    if (seat.classList.contains('boy')) {
      seat.classList.replace('boy', 'girl');
      span.innerHTML = span.innerHTML.replace(/^ç”·/, 'å¥³');
    } else if (seat.classList.contains('girl')) {
      seat.classList.replace('girl', 'empty');
      span.innerHTML = '(ç©ºä½)';
    } else {
      seat.classList.replace('empty', 'boy');
      if (span.innerText === '(ç©ºä½)') span.innerHTML = 'ç”· Xè™Ÿ<br>å§“å';
    }
    updateGroupCount(seat);
  }

  // è‡ªå‹•æ›´æ–°è©²çµ„äººæ•¸é¡¯ç¤º
  function updateGroupCount(seatEl) {
    let group = seatEl.closest('.table-group');
    let titleEl = group.querySelector('.table-title');
    let baseTitle = titleEl.innerText.split(' ')[0];
    let count = group.querySelectorAll('.boy, .girl').length;
    titleEl.innerText = `${baseTitle} (${count}äºº)`;
  }

  // ---- æ ¸å¿ƒé‚è¼¯ï¼šç·¨è¼¯æ–‡å­—é˜²è¡çª ----
  function attachEditEvents() {
    document.querySelectorAll('.edit-text').forEach(span => {
      // é»æ“Šç·¨è¼¯æ–‡å­—æ™‚ï¼Œæš«æ™‚é—œé–‰æ¯å±¤çš„æ‹–æ›³åŠŸèƒ½ï¼Œä»¥å…æ‰“å­—ä¸é †æš¢
      span.addEventListener('focus', function() {
        this.parentElement.setAttribute('draggable', 'false');
      });
      span.addEventListener('blur', function() {
        this.parentElement.setAttribute('draggable', 'true');
      });
    });
  }

  // ---- æ ¸å¿ƒé‚è¼¯ï¼šæ‹–æ›³æ›åº§ä½ ----
  let draggedSeat = null;

  function attachDragAndDropEvents() {
    document.querySelectorAll('.seat').forEach(seat => {
      seat.addEventListener('dragstart', function(e) {
        draggedSeat = this;
        e.dataTransfer.effectAllowed = 'move';
        this.style.opacity = '0.5';
      });
      
      seat.addEventListener('dragend', function() {
        this.style.opacity = '1';
        document.querySelectorAll('.seat').forEach(s => s.classList.remove('drag-over'));
      });

      seat.addEventListener('dragover', function(e) {
        e.preventDefault(); // å…è¨±æ”¾ä¸‹
        this.classList.add('drag-over');
      });

      seat.addEventListener('dragleave', function() {
        this.classList.remove('drag-over');
      });

      seat.addEventListener('drop', function(e) {
        e.stopPropagation();
        this.classList.remove('drag-over');
        
        if (draggedSeat !== this) {
          // äº¤æ› HTML (æ–‡å­—å…§å®¹)
          let tempHTML = this.innerHTML;
          this.innerHTML = draggedSeat.innerHTML;
          draggedSeat.innerHTML = tempHTML;

          // äº¤æ› Class (èƒŒæ™¯é¡è‰²è¨­å®š)
          let tempClass = this.className;
          this.className = draggedSeat.className;
          draggedSeat.className = tempClass;

          // é‡æ–°ç¶å®šç·¨è¼¯äº‹ä»¶(å› ç‚º span è¢«æŠ½æ›äº†)
          attachEditEvents();
          updateGroupCount(this);
          updateGroupCount(draggedSeat);
        }
        return false;
      });
    });
  }

  // åˆå§‹åŒ–é è¨­é¡¯ç¤º 601 ç­
  window.onload = () => renderClass('601');
</script>

</body>
</html>